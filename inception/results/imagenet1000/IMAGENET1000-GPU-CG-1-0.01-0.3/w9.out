I tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcublas.so locally
I tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcudnn.so locally
I tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcufft.so locally
I tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcuda.so locally
I tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcurand.so locally
INFO:tensorflow:PS hosts are: ['master:2200']
INFO:tensorflow:Worker hosts are: ['master:2201', 'master:2202', 'master:2203', 'master:2204', 'node001:2205', 'node001:2206', 'node001:2207', 'node001:2208', 'node002:2209', 'node002:2210', 'node002:2211', 'node002:2212', 'node003:2213', 'node003:2214', 'node003:2215', 'node003:2216', 'node004:2217', 'node004:2218', 'node004:2219', 'node004:2220', 'node005:2221', 'node005:2222', 'node005:2223', 'node005:2224', 'node006:2225', 'node006:2226', 'node006:2227', 'node006:2228', 'node007:2229', 'node007:2230', 'node007:2231', 'node007:2232']
I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:922] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
I tensorflow/core/common_runtime/gpu/gpu_init.cc:102] Found device 0 with properties: 
name: GRID K520
major: 3 minor: 0 memoryClockRate (GHz) 0.797
pciBusID 0000:00:03.0
Total memory: 4.00GiB
Free memory: 3.95GiB
I tensorflow/core/common_runtime/gpu/gpu_init.cc:126] DMA: 0 
I tensorflow/core/common_runtime/gpu/gpu_init.cc:136] 0:   Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:784] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GRID K520, pci bus id: 0000:00:03.0)
I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:206] Initialize HostPortsGrpcChannelCache for job ps -> {master:2200}
I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:206] Initialize HostPortsGrpcChannelCache for job worker -> {master:2201, master:2202, master:2203, master:2204, node001:2205, node001:2206, node001:2207, node001:2208, localhost:2209, node002:2210, node002:2211, node002:2212, node003:2213, node003:2214, node003:2215, node003:2216, node004:2217, node004:2218, node004:2219, node004:2220, node005:2221, node005:2222, node005:2223, node005:2224, node006:2225, node006:2226, node006:2227, node006:2228, node007:2229, node007:2230, node007:2231, node007:2232}
I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:202] Started server with target: grpc://localhost:2209
INFO:tensorflow:Learning rate: 0.010000, momentum: 0.300000
INFO:tensorflow:Sync mode!!!!!!
INFO:tensorflow:Compute groups : 1
INFO:tensorflow:SyncReplicas enabled: replicas_to_aggregate=32; total_num_replicas=32
INFO:tensorflow:Num nodes per compute groups: 32
INFO:tensorflow:Tokens per step: 32
INFO:tensorflow:2016-08-10 10:23:17.097335 Supervisor
INFO:tensorflow:got sessions! 2016-08-10 10:23:36.084705 
INFO:tensorflow:Started 3 queues for processing input data.
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 3768 get requests, put_count=2853 evicted_count=1000 eviction_rate=0.350508 and unsatisfied allocation rate=0.534766
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:256] Raising pool_size_limit_ from 100 to 110
INFO:tensorflow:Step: 7871, Loss: 9.666087, time: 27.949 sec/batch
INFO:tensorflow:Step: 7871, Loss: 9.290925, time: 8.822 sec/batch
INFO:tensorflow:Step: 7872, Loss: 9.637809, time: 18.453 sec/batch
INFO:tensorflow:Step: 7873, Loss: 9.057183, time: 11.573 sec/batch
INFO:tensorflow:Step: 7874, Loss: 9.461732, time: 13.832 sec/batch
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 0 get requests, put_count=1016 evicted_count=1000 eviction_rate=0.984252 and unsatisfied allocation rate=0
INFO:tensorflow:Step: 7875, Loss: 9.104831, time: 14.545 sec/batch
INFO:tensorflow:Step: 7876, Loss: 9.298828, time: 13.268 sec/batch
INFO:tensorflow:Step: 7877, Loss: 8.418387, time: 12.400 sec/batch
INFO:tensorflow:Step: 7878, Loss: 9.339634, time: 11.353 sec/batch
INFO:tensorflow:Step: 7879, Loss: 9.816895, time: 13.020 sec/batch
INFO:tensorflow:Step: 7880, Loss: 9.166148, time: 12.613 sec/batch
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 3768 get requests, put_count=4060 evicted_count=2000 eviction_rate=0.492611 and unsatisfied allocation rate=0.459926
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:256] Raising pool_size_limit_ from 281 to 309
INFO:tensorflow:Step: 7881, Loss: 8.617010, time: 16.551 sec/batch
INFO:tensorflow:Step: 7882, Loss: 9.309453, time: 15.327 sec/batch
INFO:tensorflow:Step: 7883, Loss: 8.772510, time: 15.708 sec/batch
INFO:tensorflow:Step: 7884, Loss: 9.068776, time: 12.620 sec/batch
INFO:tensorflow:Step: 7885, Loss: 8.806313, time: 12.064 sec/batch
INFO:tensorflow:Step: 7886, Loss: 9.312320, time: 10.926 sec/batch
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 0 get requests, put_count=1049 evicted_count=1000 eviction_rate=0.953289 and unsatisfied allocation rate=0
INFO:tensorflow:Step: 7887, Loss: 9.155151, time: 11.285 sec/batch
INFO:tensorflow:Step: 7888, Loss: 8.692664, time: 13.499 sec/batch
INFO:tensorflow:Step: 7889, Loss: 9.108809, time: 14.251 sec/batch
INFO:tensorflow:Step: 7890, Loss: 8.813195, time: 14.986 sec/batch
INFO:tensorflow:Step: 7891, Loss: 8.410120, time: 14.890 sec/batch
INFO:tensorflow:Step: 7892, Loss: 9.393257, time: 13.630 sec/batch
INFO:tensorflow:Step: 7893, Loss: 9.155011, time: 14.943 sec/batch
INFO:tensorflow:Step: 7894, Loss: 9.254143, time: 14.090 sec/batch
INFO:tensorflow:Step: 7895, Loss: 8.340823, time: 14.035 sec/batch
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 3768 get requests, put_count=4016 evicted_count=1000 eviction_rate=0.249004 and unsatisfied allocation rate=0.227442
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:256] Raising pool_size_limit_ from 1158 to 1273
INFO:tensorflow:Step: 7896, Loss: 9.237370, time: 14.281 sec/batch
INFO:tensorflow:Step: 7897, Loss: 9.791059, time: 12.932 sec/batch
INFO:tensorflow:Step: 7898, Loss: 9.127172, time: 11.982 sec/batch
INFO:tensorflow:Step: 7899, Loss: 7.772249, time: 11.523 sec/batch
INFO:tensorflow:Step: 7900, Loss: 9.269533, time: 13.295 sec/batch
INFO:tensorflow:Step: 7901, Loss: 9.422021, time: 13.544 sec/batch
INFO:tensorflow:Step: 7902, Loss: 8.523804, time: 10.991 sec/batch
INFO:tensorflow:Step: 7903, Loss: 8.775527, time: 11.090 sec/batch
INFO:tensorflow:Step: 7904, Loss: 9.622487, time: 10.831 sec/batch
INFO:tensorflow:Step: 7905, Loss: 8.412196, time: 11.559 sec/batch
INFO:tensorflow:Step: 7906, Loss: 9.519174, time: 11.783 sec/batch
INFO:tensorflow:Step: 7907, Loss: 8.769790, time: 11.978 sec/batch
INFO:tensorflow:Step: 7908, Loss: 9.211344, time: 12.210 sec/batch
INFO:tensorflow:Step: 7909, Loss: 8.628222, time: 12.213 sec/batch
INFO:tensorflow:Step: 7910, Loss: 9.467993, time: 11.931 sec/batch
INFO:tensorflow:Step: 7911, Loss: 8.333384, time: 12.082 sec/batch
INFO:tensorflow:Step: 7912, Loss: 9.074903, time: 13.166 sec/batch
INFO:tensorflow:Step: 7913, Loss: 8.493929, time: 13.056 sec/batch
INFO:tensorflow:Step: 7914, Loss: 8.614807, time: 13.172 sec/batch
INFO:tensorflow:Step: 7915, Loss: 8.946541, time: 13.337 sec/batch
INFO:tensorflow:Step: 7916, Loss: 9.477112, time: 11.284 sec/batch
INFO:tensorflow:Step: 7917, Loss: 9.429743, time: 11.876 sec/batch
INFO:tensorflow:Step: 7918, Loss: 8.662848, time: 12.741 sec/batch
INFO:tensorflow:Step: 7919, Loss: 9.837783, time: 12.363 sec/batch
INFO:tensorflow:Step: 7920, Loss: 9.190487, time: 11.963 sec/batch
INFO:tensorflow:Step: 7921, Loss: 9.746183, time: 13.326 sec/batch
INFO:tensorflow:Step: 7922, Loss: 8.738276, time: 12.340 sec/batch
INFO:tensorflow:Step: 7923, Loss: 9.290086, time: 13.590 sec/batch
INFO:tensorflow:Step: 7924, Loss: 9.057682, time: 12.711 sec/batch
INFO:tensorflow:Step: 7925, Loss: 9.518951, time: 15.038 sec/batch
INFO:tensorflow:Step: 7926, Loss: 8.695942, time: 16.557 sec/batch
INFO:tensorflow:Step: 7927, Loss: 9.118769, time: 13.342 sec/batch
INFO:tensorflow:Step: 7928, Loss: 9.445909, time: 14.901 sec/batch
INFO:tensorflow:Step: 7929, Loss: 9.645535, time: 12.686 sec/batch
INFO:tensorflow:Step: 7930, Loss: 8.731880, time: 12.288 sec/batch
INFO:tensorflow:Step: 7931, Loss: 9.463389, time: 13.008 sec/batch
INFO:tensorflow:Step: 7932, Loss: 8.845082, time: 12.376 sec/batch
INFO:tensorflow:Step: 7933, Loss: 9.739855, time: 13.164 sec/batch
INFO:tensorflow:Step: 7934, Loss: 9.616962, time: 10.834 sec/batch
INFO:tensorflow:Step: 7935, Loss: 9.189846, time: 11.306 sec/batch
INFO:tensorflow:Step: 7936, Loss: 8.498579, time: 12.486 sec/batch
INFO:tensorflow:Step: 7937, Loss: 8.567147, time: 11.575 sec/batch
INFO:tensorflow:Step: 7938, Loss: 8.404408, time: 12.135 sec/batch
INFO:tensorflow:Step: 7939, Loss: 8.552856, time: 12.890 sec/batch
INFO:tensorflow:Step: 7940, Loss: 9.012029, time: 12.957 sec/batch
INFO:tensorflow:Step: 7941, Loss: 8.601272, time: 14.944 sec/batch
INFO:tensorflow:Step: 7942, Loss: 9.249062, time: 12.821 sec/batch
INFO:tensorflow:Step: 7943, Loss: 8.900066, time: 11.464 sec/batch
INFO:tensorflow:Step: 7944, Loss: 9.289804, time: 13.930 sec/batch
INFO:tensorflow:Step: 7945, Loss: 8.844006, time: 11.737 sec/batch
INFO:tensorflow:Step: 7946, Loss: 8.917080, time: 12.251 sec/batch
INFO:tensorflow:Step: 7947, Loss: 8.826761, time: 12.943 sec/batch
INFO:tensorflow:Step: 7948, Loss: 8.490837, time: 10.750 sec/batch
INFO:tensorflow:Step: 7949, Loss: 9.341558, time: 12.085 sec/batch
INFO:tensorflow:Step: 7950, Loss: 9.447945, time: 13.398 sec/batch
INFO:tensorflow:Step: 7951, Loss: 9.507286, time: 12.327 sec/batch
INFO:tensorflow:Step: 7952, Loss: 9.280157, time: 13.442 sec/batch
INFO:tensorflow:Step: 7953, Loss: 9.222442, time: 12.061 sec/batch
INFO:tensorflow:Step: 7954, Loss: 8.420533, time: 12.570 sec/batch
Traceback (most recent call last):
  File "/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/__main__/inception/imagenet_distributed_train.py", line 69, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 30, in run
    sys.exit(main(sys.argv))
  File "/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/__main__/inception/imagenet_distributed_train.py", line 65, in main
    inception_distributed_train.train(server.target, dataset, cluster_spec)
  File "/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/__main__/inception/inception_distributed_train.py", line 330, in train
    loss_value, step = sess.run([train_op, global_step])
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 333, in run
    run_metadata_ptr)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 573, in _run
    feed_dict_string, options, run_metadata)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 648, in _do_run
    target_list, options, run_metadata)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 668, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors.UnavailableError
run-expr-aws-32node.sh: line 25: 20753 Terminated              CUDA_VISIBLE_DEVICES=$1 bazel-bin/inception/imagenet_distributed_train --batch_size=32 --data_dir=/imagenet/ilsvrc12_train_tfrecord_32_PARTITION/32P_p$2 --job_name='worker' --task_id=$2 --ps_hosts='master:2200' --worker_hosts='master:2201,master:2202,master:2203,master:2204,node001:2205,node001:2206,node001:2207,node001:2208,node002:2209,node002:2210,node002:2211,node002:2212,node003:2213,node003:2214,node003:2215,node003:2216,node004:2217,node004:2218,node004:2219,node004:2220,node005:2221,node005:2222,node005:2223,node005:2224,node006:2225,node006:2226,node006:2227,node006:2228,node007:2229,node007:2230,node007:2231,node007:2232' --initial_learning_rate=$3 --momentum=$4 --sync=True --compute_groups=$5
