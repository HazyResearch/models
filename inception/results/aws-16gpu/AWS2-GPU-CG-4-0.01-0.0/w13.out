I tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcublas.so locally
I tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcudnn.so locally
I tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcufft.so locally
I tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcuda.so locally
I tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcurand.so locally
INFO:tensorflow:PS hosts are: ['master:2200']
INFO:tensorflow:Worker hosts are: ['master:2201', 'master:2202', 'master:2203', 'master:2204', 'node001:2205', 'node001:2206', 'node001:2207', 'node001:2208', 'node002:2209', 'node002:2210', 'node002:2211', 'node002:2212', 'node003:2213', 'node003:2214', 'node003:2215', 'node003:2216']
I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:922] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
I tensorflow/core/common_runtime/gpu/gpu_init.cc:102] Found device 0 with properties: 
name: GRID K520
major: 3 minor: 0 memoryClockRate (GHz) 0.797
pciBusID 0000:00:03.0
Total memory: 4.00GiB
Free memory: 3.95GiB
I tensorflow/core/common_runtime/gpu/gpu_init.cc:126] DMA: 0 
I tensorflow/core/common_runtime/gpu/gpu_init.cc:136] 0:   Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:784] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GRID K520, pci bus id: 0000:00:03.0)
I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:206] Initialize HostPortsGrpcChannelCache for job ps -> {master:2200}
I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:206] Initialize HostPortsGrpcChannelCache for job worker -> {master:2201, master:2202, master:2203, master:2204, node001:2205, node001:2206, node001:2207, node001:2208, node002:2209, node002:2210, node002:2211, node002:2212, localhost:2213, node003:2214, node003:2215, node003:2216}
I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:202] Started server with target: grpc://localhost:2213
INFO:tensorflow:Learning rate: 0.010000, momentum: 0.000000
INFO:tensorflow:Sync mode!!!!!!
INFO:tensorflow:Compute groups : 4
INFO:tensorflow:SyncReplicas enabled: replicas_to_aggregate=16; total_num_replicas=16
INFO:tensorflow:Num nodes per compute groups: 4
INFO:tensorflow:Tokens per step: 4
INFO:tensorflow:2016-08-09 13:42:23.538109 Supervisor
INFO:tensorflow:got sessions! 2016-08-09 13:42:41.325691 
INFO:tensorflow:Started 3 queues for processing input data.
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 3768 get requests, put_count=2855 evicted_count=1000 eviction_rate=0.350263 and unsatisfied allocation rate=0.534236
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:256] Raising pool_size_limit_ from 100 to 110
INFO:tensorflow:Step: 399, Loss: 6.226865, time: 15.011 sec/batch
INFO:tensorflow:Step: 399, Loss: 5.910748, time: 2.574 sec/batch
INFO:tensorflow:Step: 399, Loss: 5.693072, time: 2.613 sec/batch
INFO:tensorflow:Step: 399, Loss: 5.590546, time: 10.188 sec/batch
INFO:tensorflow:Step: 403, Loss: 5.242870, time: 8.979 sec/batch
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 0 get requests, put_count=1016 evicted_count=1000 eviction_rate=0.984252 and unsatisfied allocation rate=0
INFO:tensorflow:Step: 410, Loss: 5.231915, time: 6.651 sec/batch
INFO:tensorflow:Step: 414, Loss: 5.394770, time: 5.285 sec/batch
INFO:tensorflow:Step: 418, Loss: 5.389736, time: 6.209 sec/batch
INFO:tensorflow:Step: 422, Loss: 5.372928, time: 5.170 sec/batch
INFO:tensorflow:Step: 426, Loss: 5.982927, time: 4.469 sec/batch
INFO:tensorflow:Step: 430, Loss: 5.558458, time: 4.947 sec/batch
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 3768 get requests, put_count=4058 evicted_count=2000 eviction_rate=0.492854 and unsatisfied allocation rate=0.460456
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:256] Raising pool_size_limit_ from 281 to 309
INFO:tensorflow:Step: 435, Loss: 5.040637, time: 4.655 sec/batch
INFO:tensorflow:Step: 438, Loss: 5.897065, time: 6.369 sec/batch
INFO:tensorflow:Step: 444, Loss: 5.106294, time: 6.190 sec/batch
INFO:tensorflow:Step: 449, Loss: 5.289659, time: 4.838 sec/batch
INFO:tensorflow:Step: 452, Loss: 5.433687, time: 4.018 sec/batch
INFO:tensorflow:Step: 456, Loss: 5.157981, time: 4.249 sec/batch
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 0 get requests, put_count=1049 evicted_count=1000 eviction_rate=0.953289 and unsatisfied allocation rate=0
INFO:tensorflow:Step: 460, Loss: 5.510710, time: 4.667 sec/batch
INFO:tensorflow:Step: 464, Loss: 5.589042, time: 3.486 sec/batch
INFO:tensorflow:Step: 468, Loss: 5.344481, time: 4.247 sec/batch
INFO:tensorflow:Step: 472, Loss: 5.109947, time: 4.519 sec/batch
INFO:tensorflow:Step: 477, Loss: 5.475540, time: 3.580 sec/batch
INFO:tensorflow:Step: 480, Loss: 5.192713, time: 3.438 sec/batch
INFO:tensorflow:Step: 484, Loss: 5.163001, time: 4.430 sec/batch
INFO:tensorflow:Step: 488, Loss: 5.259891, time: 3.674 sec/batch
INFO:tensorflow:Step: 492, Loss: 5.835565, time: 4.177 sec/batch
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 3768 get requests, put_count=4015 evicted_count=1000 eviction_rate=0.249066 and unsatisfied allocation rate=0.227707
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:256] Raising pool_size_limit_ from 1158 to 1273
INFO:tensorflow:Step: 496, Loss: 5.124267, time: 4.127 sec/batch
INFO:tensorflow:Step: 500, Loss: 5.071525, time: 3.866 sec/batch
INFO:tensorflow:Step: 504, Loss: 5.047442, time: 3.817 sec/batch
INFO:tensorflow:Step: 508, Loss: 5.256083, time: 3.953 sec/batch
INFO:tensorflow:Step: 512, Loss: 5.385649, time: 3.868 sec/batch
INFO:tensorflow:Step: 516, Loss: 5.170069, time: 4.177 sec/batch
INFO:tensorflow:Step: 520, Loss: 5.180699, time: 3.982 sec/batch
INFO:tensorflow:Step: 524, Loss: 5.622705, time: 3.838 sec/batch
INFO:tensorflow:Step: 527, Loss: 5.489836, time: 3.667 sec/batch
INFO:tensorflow:Step: 531, Loss: 4.830233, time: 4.329 sec/batch
INFO:tensorflow:Step: 535, Loss: 5.756989, time: 4.000 sec/batch
INFO:tensorflow:Step: 539, Loss: 5.143142, time: 4.212 sec/batch
INFO:tensorflow:Step: 543, Loss: 5.575424, time: 4.902 sec/batch
INFO:tensorflow:Step: 547, Loss: 5.188456, time: 4.762 sec/batch
INFO:tensorflow:Step: 551, Loss: 5.467753, time: 3.240 sec/batch
INFO:tensorflow:Step: 555, Loss: 5.119605, time: 4.014 sec/batch
INFO:tensorflow:Step: 559, Loss: 5.439155, time: 4.561 sec/batch
INFO:tensorflow:Step: 562, Loss: 5.309367, time: 4.404 sec/batch
INFO:tensorflow:Step: 566, Loss: 5.477273, time: 3.384 sec/batch
INFO:tensorflow:Step: 570, Loss: 5.569620, time: 3.992 sec/batch
INFO:tensorflow:Step: 574, Loss: 4.950546, time: 3.557 sec/batch
INFO:tensorflow:Step: 578, Loss: 5.155893, time: 4.253 sec/batch
INFO:tensorflow:Step: 582, Loss: 4.997134, time: 3.616 sec/batch
INFO:tensorflow:Step: 586, Loss: 4.915950, time: 3.471 sec/batch
INFO:tensorflow:Step: 590, Loss: 5.206652, time: 3.415 sec/batch
INFO:tensorflow:Step: 594, Loss: 5.078809, time: 3.829 sec/batch
INFO:tensorflow:Step: 598, Loss: 5.378133, time: 4.017 sec/batch
INFO:tensorflow:Step: 602, Loss: 5.007968, time: 3.565 sec/batch
INFO:tensorflow:Step: 606, Loss: 5.192458, time: 4.429 sec/batch
INFO:tensorflow:Step: 610, Loss: 5.049842, time: 4.827 sec/batch
INFO:tensorflow:Step: 614, Loss: 5.191131, time: 3.879 sec/batch
INFO:tensorflow:Step: 618, Loss: 5.048439, time: 3.706 sec/batch
INFO:tensorflow:Step: 622, Loss: 5.166443, time: 3.978 sec/batch
INFO:tensorflow:Step: 626, Loss: 5.121180, time: 3.561 sec/batch
INFO:tensorflow:Step: 630, Loss: 5.297453, time: 4.260 sec/batch
INFO:tensorflow:Step: 634, Loss: 5.164983, time: 3.991 sec/batch
INFO:tensorflow:Step: 638, Loss: 4.975899, time: 4.575 sec/batch
INFO:tensorflow:Step: 642, Loss: 5.133980, time: 4.133 sec/batch
INFO:tensorflow:Step: 646, Loss: 5.030793, time: 4.900 sec/batch
INFO:tensorflow:Step: 650, Loss: 5.096557, time: 4.261 sec/batch
INFO:tensorflow:Step: 654, Loss: 5.233388, time: 3.854 sec/batch
INFO:tensorflow:Step: 657, Loss: 5.430824, time: 3.529 sec/batch
INFO:tensorflow:Step: 661, Loss: 4.841262, time: 3.817 sec/batch
INFO:tensorflow:Step: 665, Loss: 5.182769, time: 3.670 sec/batch
INFO:tensorflow:Step: 669, Loss: 5.225737, time: 3.841 sec/batch
INFO:tensorflow:Step: 673, Loss: 5.047095, time: 4.215 sec/batch
INFO:tensorflow:Step: 677, Loss: 4.933792, time: 4.751 sec/batch
INFO:tensorflow:Step: 682, Loss: 5.363695, time: 3.770 sec/batch
INFO:tensorflow:Step: 685, Loss: 5.396660, time: 4.784 sec/batch
INFO:tensorflow:Step: 689, Loss: 4.915915, time: 3.449 sec/batch
INFO:tensorflow:Step: 693, Loss: 4.913348, time: 3.812 sec/batch
INFO:tensorflow:Step: 697, Loss: 4.896091, time: 4.335 sec/batch
INFO:tensorflow:Step: 701, Loss: 4.953685, time: 5.284 sec/batch
INFO:tensorflow:Step: 706, Loss: 4.840687, time: 4.794 sec/batch
INFO:tensorflow:Step: 709, Loss: 5.177906, time: 4.499 sec/batch
INFO:tensorflow:Step: 713, Loss: 4.948329, time: 4.216 sec/batch
INFO:tensorflow:Step: 718, Loss: 5.349435, time: 5.978 sec/batch
INFO:tensorflow:Step: 723, Loss: 4.996270, time: 4.194 sec/batch
INFO:tensorflow:Step: 727, Loss: 5.195583, time: 4.284 sec/batch
INFO:tensorflow:Step: 731, Loss: 5.071728, time: 4.730 sec/batch
INFO:tensorflow:Step: 736, Loss: 4.938029, time: 3.856 sec/batch
INFO:tensorflow:Step: 739, Loss: 5.365632, time: 3.517 sec/batch
INFO:tensorflow:Step: 743, Loss: 5.069480, time: 3.546 sec/batch
INFO:tensorflow:Step: 747, Loss: 4.970951, time: 4.163 sec/batch
INFO:tensorflow:Step: 751, Loss: 4.977844, time: 3.990 sec/batch
INFO:tensorflow:Step: 755, Loss: 4.979856, time: 3.940 sec/batch
INFO:tensorflow:Step: 759, Loss: 5.049661, time: 4.135 sec/batch
INFO:tensorflow:Step: 763, Loss: 4.982646, time: 3.795 sec/batch
INFO:tensorflow:Step: 767, Loss: 4.952535, time: 4.108 sec/batch
INFO:tensorflow:Step: 771, Loss: 4.992719, time: 4.362 sec/batch
INFO:tensorflow:Step: 775, Loss: 4.954890, time: 3.430 sec/batch
INFO:tensorflow:Step: 779, Loss: 4.876405, time: 4.297 sec/batch
INFO:tensorflow:Step: 783, Loss: 5.080023, time: 4.070 sec/batch
INFO:tensorflow:Step: 787, Loss: 5.073183, time: 3.964 sec/batch
INFO:tensorflow:Step: 791, Loss: 4.911096, time: 3.682 sec/batch
INFO:tensorflow:Step: 795, Loss: 4.847724, time: 4.459 sec/batch
INFO:tensorflow:Step: 799, Loss: 4.771846, time: 4.270 sec/batch
INFO:tensorflow:Step: 803, Loss: 4.834499, time: 3.502 sec/batch
INFO:tensorflow:Step: 806, Loss: 4.940677, time: 3.869 sec/batch
INFO:tensorflow:Step: 810, Loss: 4.873615, time: 4.384 sec/batch
INFO:tensorflow:Step: 814, Loss: 4.856082, time: 3.716 sec/batch
INFO:tensorflow:Step: 818, Loss: 4.895356, time: 3.519 sec/batch
INFO:tensorflow:Step: 822, Loss: 4.652390, time: 3.459 sec/batch
INFO:tensorflow:Step: 826, Loss: 5.069406, time: 3.897 sec/batch
INFO:tensorflow:Step: 830, Loss: 4.761533, time: 3.763 sec/batch
INFO:tensorflow:Step: 834, Loss: 4.977889, time: 4.457 sec/batch
INFO:tensorflow:Step: 838, Loss: 4.929385, time: 3.556 sec/batch
INFO:tensorflow:Step: 842, Loss: 5.050273, time: 4.153 sec/batch
INFO:tensorflow:Step: 846, Loss: 4.680613, time: 4.245 sec/batch
INFO:tensorflow:Step: 850, Loss: 5.198849, time: 4.613 sec/batch
INFO:tensorflow:Step: 854, Loss: 4.968671, time: 3.659 sec/batch
INFO:tensorflow:Step: 858, Loss: 4.656657, time: 3.516 sec/batch
INFO:tensorflow:Step: 862, Loss: 4.880265, time: 4.427 sec/batch
INFO:tensorflow:Step: 866, Loss: 4.838654, time: 5.155 sec/batch
E tensorflow/core/distributed_runtime/master_session.cc:923] Cleanup partition error: Unavailable: 
Traceback (most recent call last):
  File "/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/__main__/inception/imagenet_distributed_train.py", line 69, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 30, in run
    sys.exit(main(sys.argv))
  File "/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/__main__/inception/imagenet_distributed_train.py", line 65, in main
    inception_distributed_train.train(server.target, dataset, cluster_spec)
  File "/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/__main__/inception/inception_distributed_train.py", line 330, in train
    loss_value, step = sess.run([train_op, global_step])
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 333, in run
    run_metadata_ptr)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 573, in _run
    feed_dict_string, options, run_metadata)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 648, in _do_run
    target_list, options, run_metadata)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 668, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors.UnavailableError
run-expr-32node.sh: line 25: 39918 Terminated              CUDA_VISIBLE_DEVICES=$1 bazel-bin/inception/imagenet_distributed_train --batch_size=32 --data_dir=/home/data/sample-data-$2 --job_name='worker' --task_id=$2 --ps_hosts='master:2200' --worker_hosts='master:2201,master:2202,master:2203,master:2204,node001:2205,node001:2206,node001:2207,node001:2208,node002:2209,node002:2210,node002:2211,node002:2212,node003:2213,node003:2214,node003:2215,node003:2216' --initial_learning_rate=$3 --momentum=$4 --sync=True --compute_groups=$5
